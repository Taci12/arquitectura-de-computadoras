TIMER EQU 10H
PIC EQU 20H
EOI EQU 20H
N_CLK EQU 10
ORG 40
IP_CLK DW RUT_CLK
ORG 1000H
SEG1 DB 30H
SEG2 DB 30H


ORG 3000H
RUT_CLK: 
  PUSH AX
  PUSH BX
  MOV AL, SEG1
  ADD AL, SEG2
  CMP AL, 06EH
  JZ IMPRIMIR
  CMP SEG2, 039H
  JZ SUMAR_SEG1
  INC SEG2
  JMP IMPRIMIR


SUMAR_SEG1: 
  INC SEG1
  MOV SEG2, 030H
  JMP IMPRIMIR
  
IMPRIMIR:
  MOV AL, 1
  MOV BX, OFFSET SEG1
  INT 7
  MOV BX, OFFSET SEG2
  INT 7
  MOV AL, 0
  OUT TIMER, AL
  MOV AL, EOI
  OUT PIC, AL
  MOV AL, SEG1
  ADD AL, SEG2
  CMP AL, 06EH
  JZ REINICIAR
FIN:  
  POP BX
  POP AX
  IRET

REINICIAR:
  MOV SEG1, 030H
  MOV SEG2, 030H
  JMP FIN
  
ORG 2000H
CLI
MOV AL, 0FDH
OUT PIC+1, AL ; PIC: registro IMR
MOV AL, N_CLK
OUT PIC+5, AL ; PIC: registro INT1
MOV AL, 1
OUT TIMER+1, AL ; TIMER: registro COMP
MOV AL, 0
OUT TIMER, AL ; TIMER: registro CONT
STI
LAZO: JMP LAZO
HLT
END














